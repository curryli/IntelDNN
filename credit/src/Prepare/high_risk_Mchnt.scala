package Prepare
import org.apache.log4j.Level
import org.apache.log4j.Logger
import org.apache.spark._
import org.apache.spark.sql._
import org.apache.spark.sql.types._
import org.apache.spark.SparkContext._
import org.apache.log4j.{Level, Logger}
import org.apache.spark.sql.SparkSession
import org.apache.log4j.Level
import org.apache.log4j.Logger
import org.apache.spark.graphx._
import org.apache.spark.sql.functions._
import org.apache.spark.sql.SQLContext
import org.apache.spark.sql.hive.HiveContext
import scala.collection.mutable.MutableList
import scala.Range
import org.apache.spark.graphx._
import org.apache.spark.rdd.RDD
import scala.collection.mutable.{Buffer,Set,Map}
import org.apache.spark.rdd.RDD.rddToPairRDDFunctions
import org.apache.spark.sql.functions._
import org.apache.spark.storage.StorageLevel
import org.apache.spark.ml.feature.StandardScaler
import org.apache.spark.ml.feature.MinMaxScaler
import org.apache.spark.ml.feature.Normalizer
import org.apache.spark.ml.feature.StringIndexer
import org.apache.spark.ml.feature.VectorAssembler
import org.apache.spark.ml.feature.OneHotEncoder
import org.apache.spark.ml.clustering.KMeans
import org.apache.spark.ml.Pipeline
import org.apache.spark.ml.classification._
import org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator
import org.apache.spark.ml.feature.{IndexToString, StringIndexer, VectorAssembler}
import scala.collection.mutable.ArrayBuffer
import scala.reflect.runtime.universe
import org.apache.spark.ml.Pipeline
import org.apache.spark.ml.PipelineStage
import org.apache.spark.ml.PipelineModel
import org.apache.spark.ml.feature.QuantileDiscretizer
import scala.collection.mutable.HashMap
//import org.apache.spark.mllib.stat.Statistics
import scala.reflect.ClassTag
import org.apache.spark.ml.feature.OneHotEncoder
import org.apache.spark.ml.feature.ChiSqSelector
import org.apache.spark.ml.feature.ChiSqSelectorModel



object high_risk_Mchnt {

  
   def any_to_double[T: ClassTag](b: T):Double={
    if(b==true)
      1.0
    else
      0
  }

  def main(args: Array[String]): Unit = {

    //屏蔽日志
    Logger.getLogger("org").setLevel(Level.ERROR);
    Logger.getLogger("akka").setLevel(Level.ERROR);
    Logger.getLogger("hive").setLevel(Level.ERROR);
    Logger.getLogger("parse").setLevel(Level.ERROR); 
    
    //val sparkConf = new SparkConf().setAppName("spark2SQL")
    val warehouseLocation = "spark-warehouse"
    
    val ss = SparkSession
      .builder()
      .appName("Save_IndexerPipeLine")
      .config("spark.sql.warehouse.dir", warehouseLocation)
      .config("hive.metastore.schema.verification", false)
      .getOrCreate()
  
    import ss.implicits._
    import ss.sql
 
    val startTime = System.currentTimeMillis(); 
 
    val train_ori_df = ss.read.option("header", true).format("csv").option("inferSchema","true").load("xrli/credit/train_trans_encrypt.csv")
    val test_ori_df = ss.read.option("header", true).format("csv").option("inferSchema","true").load("xrli/credit/test_trans_encrypt.csv")
     
    var Trans_ori_df =  train_ori_df.unionAll(test_ori_df)
  
       var label_df = ss.read.option("header", true).format("csv").option("inferSchema","true").load("xrli/credit/train_label_encrypt.csv")
    
    label_df = label_df.select(label_df("certid").as("certid_label"), label_df("label"))
    
   Trans_ori_df =Trans_ori_df.join(label_df, Trans_ori_df("certid")===label_df("certid_label"), "left_outer").drop("certid_label")
    
    
    Trans_ori_df = Trans_ori_df.na.fill(-1)
   
        
    val riskMCs = Array("08bf167705778e23dc8966783d2d91ca6b0e8d9c922095a33380e64a16e49d6d","c383c1caa0011dd7c29922cc81cd0c4a3013e06cc4c204770235f8c9be27b1f9","972c9192d5017e4762c9e4b501e4fd6eebc31eee26fe51187d8aa5b4b2e18aba","a76635f26b6016f935b96a8812255b4e91504df69eb89970da9e1d351c258d37","fde56548e8f3443529835f55185195a2663d8025cc001fbc5eee1558177848e5","9ac918b778217ce618955b23665c3bd3b7e6bae21a92f208ab55a7a9ca052a73","5761a35ac58fce9f5d335bc825a1f291130ac2c7ba5c5acf489d3a118b9aa6f8","d260a7cdf9b7f093c97c06624d9ea5ccfc487fb6a640e7b63ef2fd4b43e341c2","034e22f5289cd28819bc93a0aabc5692828b1c96d9d43bce14f9dc75f8df39d4","de7c2a827b9e62406c49fc8489f0af96224f5da1fd947e99b070301a408c9c24","3823dfaac21208228ff9367c55966f1d60588339be953303a855bebda2758616","4f22bff576c6619367d2b67a882d3ac8f9e8a83a51b8caf689441309ccac39f1","8f72e558898e98177cd2d2d7f655deba62e50357af52a175c7f63deb5fe321c2","796fdce09c8c84c83ad1cdf23cb5f5f87e7b4817dbca6f348f3ebe5ad3d424c6","6aacecf18ffec7f0d651bdf13e75f667c4d8e838fc0277af9616ff6d45cd43d9","5e1b28ab5dc791e5e653864fafee57535cba9f9f5472ac039d9b8186d99454c3","ae22a0a2ea0697a858b541295bbf84bb3c5c94d21768a80a83ca5ec82691dfbd","e67c90ee23f3f8037923e65521bfed9f2056cd03e808b99f8d0510d6187b34f4","87131253796b4f95f119e98b142fe0adb922c27ffba9be15caa3e81688acb8ad","b065277b0d27b695239dbfa3e346a73672604d888430b5abe71c637cbfea3222","87c813421eb565fa4fd86bf86e8dbad6ab792ea14844acdcc6793d8e42ca92ce","7869dc3415fb371441737930ee4b70ba6a60b71f0bc1128dc5f86b2da18a8bde","0860b283afb7c71bf199e255efb0f154c2dd1847e27d066930bf9d04f1bd72ec","e1d7c5d56c61f8e3bcba8cfbfc02282e539ad9c34c979e87d1114f465e0b5b08","6b6e81c9e61c5550a9bbd8ce5736a8bbc447dd5273b074078d264a406ebc1cbc","57d9580be7d41f488853d757a9f4f366270f84765668e5900c909be20cfa3ce1","be91835426d870682eb4b9ece73abcc506c39f905413dd6e0ed37fdb7401c389","ce51554134500b005141f8c04fa982ceba7d06a27ab3c4212b35adf3d11852cb","7f70c3d6f98257a5d7ef3ba9d5373246341552a0707d6a1b13282749a0be9a7e","b7bdc4ed3c7af36128f1d8d3e62b36ecf84f1a1c7818cd0031560fdc059a056e","6abad658597aac5b657ab9a6de402e4dfa07ed9c7d3f222e17c03837a19bbd17","3abb20a77bca098e21acf2cbdcf7ce7d6d5c5285554ade331df10a7cc4e14188","22ab3799d0311e16f1d2463d894553c0826762a89e243383a8d315c9ebc723b6","15fcb9797ef05b5e5fae9beaef4e82d91617fd1b854a5dd79542362219dba5b9","bb129dfc4a9353a9d51c765fea7418a2c93c8e647c57bc14a67437ad6c3bac81","f37144416350aab3f6757905a357b7ad075a1dc4beb661753365612dcc442392","0e730f3c8cbc46616c333973a7d1f32aed078a230fe3f51055b7ce218f756433","0d2461074c2212d244f2bea14d0cb8587a8e6d8557cef709a80ad59153ed4b63","8917106ce70eb356f095d4ec9dc595a8898015cc284ffecd7deac90cd6299a73","5035f49bf127f2116c140c059252478fc251dc27804adb4676e4e18931380d7a","81ea1a6af66ce510eb9a288b94363e716a3effc82d3e5f800a402a797a0eda94","a1f67db69c191bd76f1270e99bbcfcebec69e1c5bb49f34c750b105554e1579c","5f3c2acdabcd321086277f759bbadb27a2dcd43b95238498b379c53c483fb004","a6e2dcaeb228a0961e545841716f6e55c35293863dd6c9345de9a3d373b4e30f","3f1d8165fa5eec21277f6b287765f886b83f29e84fe5be745cc8621aa29cb7f9","6e710b39d1c1049ec57cd49b321f29763b3dae5d9d86af65a31bf9e8a504141b","8eec3d7e48ab94416c88b9c17b3a7fe84fcedfd84ba354cefa8029ee88442523","2a49e4582b741c6a7aeb02faa00e7cffdf8bfde314a5a5249fae363ef540faa5","67e681b84fa356b2fd060282e13985afd1c20e95e6e8f498b2e3e244f08f549a","99ffa5cc7ec67494d14199bf0fd4b1dc9896fae2a6a765314fd43054b5c8692c","f48df843331a92254e34cd7ad120e7abad9c425b6d5779bb255db304106ad721","5928b875976639d7af9765135343a6fab31ead4b4937f94ca1598d31348cb34f","cf978d342ce624ee72333eeb4de3b338e5920e360d2371c3c8b47458c15771a1","e35012b5a24b3ba3b694519a3b074031db026b32e357cab3993a267c8a40e509","8886614ad79e2bea8d3d19b6c5ad26f1b7725fb2de0fdf841c03ad5cce9de725","4485329e52701b069ef5c91f54b3eb5e5262022d2833adb415b426280e19987b","4768bf60e90ef81c4b9b61338d4a19a976cbcdbcadc2cfe85af1e03a8c98acd5","08a0a303aa1d4572d9c815cfd4fd308c29c58f8bad7e4033ac0f5acc176b82fb","8b3c789864a35301928d119af54cd46d9c7867cab4edebfdb7ed807580ca627c","eb445cb76088bcfb5b12e160f6829950199f289e29f3ae615822f2168ff9bde9","1b098995bc2f2c8090833e62379a24ca07f2deaaec1687ab9acc5901bc5c1710","1d90e2ae625dd8876ef60f1d34fefc7bacf4d57aca07e23c430d9f3dceda1125","4fb10ea8a8134f2567816ee859e16a5b9d3b6bf6949b489e76c0522b31249172","54ffd7fd1cb6598b44bcabc69ba801f8b2aea2cd87eca36c0e4cdd6a9f1b4015","0d6d3df2b1c5a2f7f224a2d1a23bbe8171f1b0bec8eaa9012c346121bc33d281","b254663bc1595682e2ca43d3662cabb889d6e331d9d090fde2507543b7ce521e","dc88ab0fa4a323a967722cd41b66515a2f3a875c5061bbc511d4270865320e26","58a6dd2b35ae3c344cb1303bd45eefac63ea63b57097f430ff95e86f7ff30e7d","d5e9bed52fadd9f755ce34b041c1c8625cf1b40aaeb7845eb8e32adac2c5a898","482da7791e717643cf34f965c5439287de8be5421e26b0acdcdcf4a3cf10f213","e39290b7a47524628a49b276c845c5ed093e6ac627e2d0a28f82e310b5c7657c","19d879b5ce246cf0dab74b1aa68054bd70b5e0cfe5702898ac2f15a7c5ad9855","078ccc631cdad03cffd60981e517a7c1cfcd5f833689c9363c2979fefa171e6c","8fd435433539864610c3904fba0031a497f5c998a4c3601438bf4ee3f4690874","f5dfe48f79e84c3e24bdde51d8c5e0827d150f6cef5b4f289a8153024830b135","0f27b0ec921f32eafbab5a8c4f2a2316ca50264daeaded1b5c2025e97d43241c","3e15e092cfaaf9c35cf93d7b7a43d031769ba1023bb7930017cf4acc77fd95fe","8f304847392c5538a411522b43b5ec83a6fd233036a33309907116828547f154","b7b7f3f03c1e30de8b29e0060f076ed20fac2d2dc6d550efe44633fe30507176","330657afe8f0a73097281c3eebd4b531ff3beb6934db69072da48673e3baef49","6757021e7ac7b24b2a26361124d9ad5674ebd7599b7b3b9c689d60d8fad3b1dd","d8e1f0d45f8e88da6e84214e520fe93acd034e478393595b2b88be7f7aa59cf8","9d4b83ce8f0ba1296fa3f1a28623c1d96a709405dfd1006dc6211ac44a773744","9ae78c8cf8eac9cd399f00cec1319f0fcf60788791f6ba29987ec3d8258f559a","3d058a2a924b563aaa5ec45f4fb650937d9fd7b547e27de1b0226b772844af58","86a37590022f0b60eaf9d8d434fba1fec7328ef9162324abe3137de7735c44c7","0325840463b65f6361cf094cf46f49037987425e3e1220db3b37e614b46469b7","a9ad1049cadbc15f0f5578c5e6e745b76fdbf48165935f900b4b363a55d37da9","d53d5656a4325b21efb88ce2beb243175314957bcfe4e3e1542f9091c973d616","d0efe7579412b904d84d321d4803c0f516c4f3721300864df911cc0382e60d91","ab97cc194482e3e7a9cfba399b40c2a498480dbe7df848d8ab2dad8cd7a1b1f5","47b051482f2f3597945e72b7c1ea0def5eb42b0353609da9a75683d83a22ca4c","c60b5d48dd1ab29184ce37f555833e48fd994b1341d1b92cfc3333f5307bda5e","b6d86789dd6aea4c947264b997bc74bafdc9a7a0d0ba49343de641bf2c246f4f","11e43c8dc577890bacc0c2d3283a277935fb0d953481e3f6e3fc5a40672c1974","d6c228c2ba75927f3e2bbd960f3ae3db29b5105f0a04cbfbda19f308bf229041","66dd129dc306d5fd5bdeaf2a09f219857496a717323ff695d9438e0234ce2d86","e1f390afec5b3bbe69c173df2c5e15eb61095d3c98cc8cd91284c3566b671881","8e9923fdc54e1dfe0ce683fbd00f47117fed1e4a0919586a2791b14701b71c02","e66511fd7eb52e97fc7a3484ae9013a24da38e0a1c72761a271cf9d1d04def5d","4a5533bed4a1166889da47ffdcca90847d3aee84e476394f943e05f6e0264e91","e684f8412ec70f875a73d9088027392051a4ade36a0edf82da2a073993160271","a977daa1b251796e5ce48711b47c41b94429aa69ec729819dd0a9230989e74de","b0610c63b1dce5b44a6822cee51cdc0856267d15d1b9121ffc33036d11131522","4b631629f57000b608500eebc2134bcabb43d60525c2d7a635d0eed26faa30ee","b0e1d7d6b087cfb6e34301fa15e59e855e925eb6bf165f36527e723d45f5f15e","116f90da41c77846a468450ece5a6f33d6a54550e307a7b7ea9425904a7b555a","469d0d3914e39b4de7df4ebdd04df096816497d277dc9ebdf32d5aa01c34fc43","36de568bcf219493ac9bfe2053e85c4ee5a9fea3a1e9eaf03efc8cfd4c98066f","e5f06838c6a893282bddf760f62d1a8f65f49ffd0a008ce9ce71930c47bb5249","2314e2fbdfa7a6b4b0631d4ae2b0e274977611373d32edb4ea8c45a46ceeeae4","b3cb07f318a4b38bf1099d98dc2641c8bf29c960062a0014d91802c23dbdcd73","ab27d4737501c0ad47b82182f9264501873fc352cad05c95ac58c58227bd0b80","40da2d593d184c7b2f67bcbcf0a47af89c98d140643ecf366a050d96b74b9745","5b1a7c5d68ef4d7ce8b3d5a519bc529075413715a6b5a6df960dba584c53d976","0713c8547251effe2c719283333d47c5ce4d29180178f0a1e6643453c12d90a2","8770bc27045a98e11f32ffd300db9f32fc2988e30828da900815f6adf06ffbbb","9c0894a025bac5e74dad01d3c038ad7ba4cc4158b570c048ce18c6f794374e27","888b16031285c5c7c92a747aaca8fb3d80236db647af5b2e8aefa7ebedb489eb","b0d25195993f8c8585a617d43285bd4f28b25c2956754e81d8bdfda32a698a1c","8dc0103eb63524cd92d3d7cdf0d4e642458044356f0d388f8cd1bb1b295b952f","0e643aee0a64dae93ed450920c4d0b4b3d40d29ff7208c57039539b0047499dd","4df610027c8142817ebf1b3a4a7506188bae85e0041f7fed6d5f3d5880b1bcc6","c6eb8e77c3567bbfa569b8756cc52c7b18b09ed51ac5cf99f98aea0258daba61","20031b5a9b9c1441bfb314ca62e57cdd8b6f4aab3471355b8f935872df72dc4e","9ba5ed44c62d459369392c003d5d204f4733962cbff37b064c295103d4540919","da95bed5feb5f18c63f12f046428a26220efec84bd889953122c653572b0e8d2","1adc82873832f8f3969bb87b3f5be3f50b3e1d8241320f6627b3df4cf6d55094","ea4fcc8452ff7900fffc8a1ca75fa9caf507b5c4dcfd8834bc2604aa7ee9732e","5206548ce9297c045acd7babf1c2847a12d7ff2d545417086fab918d23a836f6","05f21d02967203de80db5d141dea422b08816409e1e687cdf2334aabd1a31472","511cdd19d967a7c921b39fbf1567b4008fab1fcad0d31b163f883a105ce03d51","bc42f850db219a07aa712b60834d5f4d81515c16a6b975aef1d810dae62343e2","922f40274012e3a44999cb44629911ba5174e9ddaf6ab1493f7029f03d7c38fb","03f207f12a4f98e4724924605ec5a51842d54f01ebec22aabb61caf73e8cfe88","1fd0bf9e0b7d7ce1cc80fffd5dd85139cc01cae485b97f197091e4e76c1be2b7","8dd7eaa095a9004c34eaccc98d1854e6dc28faba25c3dd9bf2bf8b5cdf2d673b","37037bbbcc0f4de04451ac38d8e85abb021ac9738a08da737c9656f0af3b1437","84adf34d812074747e527534f0288a24db5905b8399322d22299bf8a1a7ff4b0","b87816f1ab116fc35e38c3d52c37d8dd5f1d4e67d284210c7a681b49682ef86a","2cd542078bf7fd1ddcf77f47abc3fed35a8d6e2ff26f06aa4bf190540f842947","d2db9534f248857c4d4bb5a09de17d014ed5d28c62098fc593586eca453efb83","d736e74f39d07b0606844bcd115911e841dfeeb446e695aa007f8ea73dd67904","f1e5e596d61c3de75f439de8a4e15e9c42b8b004e3f782a97e0b1f5c2bc11851","25907cb8f6aa8e06276846bdf2922a28a762e52213fd063ebf73acb904ddeaf0","96577bf6fae7d055a17f01b3fdb029bbfaf3c2ec69a5c9f9e68741eec0281c32","2607d6aff63578b3899ffdf4a92bd751848797fe2ae059bec623d767ec368180","490e8e9a573506d4dc60fe1c8652cdb27277f750c5d4b2846151404b38915295","2a12988f2539a9f72fc4625a237c3e392b8702031d66db29464175a4b8b12d4c","04a63e4fe0e68c0bbd0275bffb05d00cd43513dd2a1c8ed36dcad1ecb7056fcc","a6c4ff8bbf146d05be741a36df8388ada28ddbeaac336f03dadea4677bfe37f9","056827dd7cd32ecd5387a652f94dbb79fa08f4192b48f2c0bab3c9d54b02a5dd","16c6d3b24358de81a518a0487c7f5d596e8966f7c25453f81f3e9564ba638458","7da688cf5d9e3dea422878cca49b606e9dc4a05010c0923ba0a8a2af5474a45f","dc9f9eb1b13538a396aa375049d785a7470f738bac48e7611871f1648f4849c6","d079c099ac261069e68aaed3b72a3f6f040d0a19c8383224f5e26be10346b723")

    val is_risk_MC = udf[Double, String]{xstr => any_to_double(riskMCs.contains(xstr))}    
    Trans_ori_df = Trans_ori_df.withColumn("is_risk_MC", is_risk_MC(Trans_ori_df("mchnt_cd")))
    
    var count_mcc_df = Trans_ori_df.groupBy("certid").agg(sum("is_risk_MC") as "risk_MC_cnt") 
    
    
    val Bads_v1 = Array("706150d1372e575065a27137fd9c690add6f62b3685092c8642f76502cf197d7","14bdcd6fd64180af5e7791df91b6af8e9a3e7bc844997eb8c29252706df97ca5","ffa453f58b9b2ffa546af57d7cd85a997464b5b1f553638b210614f67cec4021","de9137f7ce12c76002f4102b5e037596e2dd4d258ce7452f1c0e5a3b6bf38248","1f9746ca3fe3b00784e3dadddf635b744a833060098f0d4e1285d933799de18d","c4ac71eb19c4431c82d237d329a1b09aa2af079e79ee5838fdac6625cd16d67c","274901cba997623bcf19d5078692f9275dc3e56b1d1f1e26ac16864aabb69858","95cf19e06193c93d76b8096f6209a92dc28df233580e5da2014b3034b8cccbd3","ba296d5719b764a0c4d19433a21fab87877ea18169d5d98ea54a133db74cba28","c4b1a3abbac574999ae883f32110e81646ec68668c4d4805b2af56edd2d4438b","cda3287913b2dafab54e064f0a2261c0e89a7da326ac2594eaca75ab7d81ee1b")
    val is_Bads_v1 = udf[Double, String]{xstr => any_to_double(Bads_v1.contains(xstr))}    
    Trans_ori_df = Trans_ori_df.withColumn("is_Bads_v1", is_Bads_v1(Trans_ori_df("mchnt_cd")))
    var tmpdf = Trans_ori_df.groupBy("certid").agg(sum("is_Bads_v1") as "Bads_v1_cnt") 
    tmpdf = tmpdf.select(tmpdf("certid").as("certid_2"), tmpdf("Bads_v1_cnt"))
    count_mcc_df = count_mcc_df.join(tmpdf, count_mcc_df("certid")===tmpdf("certid_2"), "left_outer").drop("certid_2")
    
    val Bads_v2 = Array("e27a7686b8028cfee7b57d954c3abccfb2a701968925f52bbd482e77be5de0bb","82e1f126e59a1a2bf3f67860184bd30324c920f630b12cef1ff45929607a6d10","92f78867ab12931f8e13ef5b373da5900d2e35c27d0b164bedb02102d81b7a2d","a9047ddf5faf92646721c903d173a65d336d32a55e53f1734aff1c5c44248655","23555150e6efb6392ffc1769c7545272a1e3b836c45475c71e2174873b699f1f","629442aedac123817dbba1baaf08a9938b867ba9b89e275487c4cc4465cac4a0","c2ecef6105c8d96b7c0c345d8d13f2f13c68cf4aa81cd432abffca81ea514009","b656eff600605c4f183d8621eab132d00103780054320d37e8da1d5ea11992bf","2292d9c07bfd516bf752300a55f7d4d68aeea62e075ac03ca95c85d9a96601d6","b1c5977c45c20ad6cc5ddb3f8ad0ec3b2214c06207830ee0292bb6f4cd440b87","e9fd1e542000e4179239caf87cf679c41e16fab73b80c624a364c47405d13d6e","ac06291590db37bf8d580a756dfecd8b80a2e077297ab2a3796b92437c13e518","f77e084215d14351c5ff41bed4045c5550bbad0324242956ce7cd8d6ec2b1e7e","942218092f46518d14f69b0000f18450f42816081ecf2c9d4334f9dad4532d88","3e6d73a0cb349743677fe160469d428e0ad09e0992fff55a61ca59db001d4aaa","6c93d57272e09e3b0eb23d34a5f78bd1ebcb6633c230835d2204e4bdf9b4d7da","a615a9576e3e5e88a18acd31e234b1de866bf63bf319c22314de6c0a005f26fe","ea538f5c320bb99214cb676d65428bd7ca5efd514b693dbb32cbe5dfd4a3ff09","78739d0d0979d4c68f7447130404eea8af6d379eb5dddcd4eea7c6ce1a31a36e","7cc5a15912ec8a20d41e065b190b73ada743b40d758246b0f563e1b0c46d15e7","741b2039ef08910cd8e7605b14c0ef5f49043d7af339ea8c9f5192dc185fe00c","5f9aba3871e593423c9e246b6eada8460e597de2bfaf2c93acd758e9530c0daf","f397694333442910d4366b4c181ee70630fc92333e05d6f49592a292f3a72dcb","9ef67051625e22d147b5c7612ef1289e37fc38c0df39e3cc0c0f91f33c4a5fe0","2c21100fb4032ffc52040aace7379313a8977ddfaa9c6eefb741dc8427e51cec","56bd676e4285685cbac88e2f29b89eee947bcf7bc4fe9b7bc47374130ddefc8a","46a9db47c943f010e1e54f1dd0d015d21ea49d3fc2d85eb9110aa599b8032331","88008caa2a1d2e1212abacda82163b1f3f228da52f387cf5af3f6cfd1b473688","55c7256a1a4dc093f33889141646cd723e5a224f9afce85ae9c9166c5b11f472","63c176448d6c6300c259c4bfe9e3b96bcae4aa7141fa3e30727d2ba602eef002","62621dc05aaf8b5763c080a58a3d7f2c578e25338f88e3e71b789b69715a02a6","b3e0f3f33e1d1df637048aafcb1980d96b846610f53f1c6fa42ad25712560c51","c10e521654a9d95ccd03a61af382a4de067f724db6ef3f7d21dcdb13fde631b6","f1c77865397864f9367743bd6a9e1a0f43e067293e8e0a735714436405bde355","566316128289fb194611f5ec9e7db27b663db2b33fcf2831efdb4f5b0b140fce","07faef48dff09374dc57bc3e06573577797d1305eae55862bc01346c830fb9c8","45f4bd3a87406698d9c8a693e0e6e853bcfd45fe59166c62e1876a4ea567075a","f0ce940227ca19a58f2cb224fdb426d70a1c9844fc10a951def01eda72ad71c1","6cf6957b33a8bae16acdd4facc9ea1f8a0dac5a8a79eb07ce95600c0053001ab","946a7f44eaf9ebc10e003384fba30124facff0b5f2b6069e6ed6f4d3273b0835","d2d59adbd7b88ec922296c2a342d1dfb7736bc226215bc598460a2d9570ac359","7a434fc5c59ec0b8fc7e66fed288b4b7ea46024e2ff8a6ce514a2ac8dcca2377","8206aeb5cdc5d6a81d7313350388266faf33053f9a56ac8e8df44895412ca551","3bbdd8a9c1d44f5924fc4b7d80fa6b82e6012ccba4082bc400b3cb9b9ad19a4e","38819745e7bd91a1522383cc0f1c20aa22330afcd92f9555d6ffeb5b57f5f161","15fd5d98edf618fe596966d3bb998ceb029ff192abd5a6f2b67d74c4d02a6b24","9fdd2f45f6121500e1a7793c37013a69887ec05b851270a22b8afbd44886fd46","a691859b594add3afc26b7d112cbd04251f5c516a40563512618a43770bf9758","6f788eebe560f06902fd1c7b8f8d76cc0056273041da827b98017db06883bae3","2f15b22403d254ea9a74447002ec9e0114b6b2368073df7816b5527b3e47972f","a6df056a05bb0c3994673276f08f7ef2f007c74fb14691d9a1487e9087544f42","8264be9ab28c8cea578143868f027774efdad6b6b71ae385b63fb853a4956b76","e02298055d44775937943c18f3e0d9cdf96e47ea987204151ccd4e6bcd32ce76","91e1b8b656df09e370915e6fbcb19d3b44081d82d6e318572b50547259fa7d78","c5bd29b241f21979890a55232b8ea6ad36bea6e31d7ab2e23930ac95609e71a8","475c60674900d0991c720c872d41a41f50f4f4e40301e984fdfcff9fba31205d","e66d7a65b872fb2fd98b321a49a1f8c5277af6f0a45517f8bedb39dc374a6ce1","740915a3c1b16cc7ae5c59cc556d720d552dc4cf40ff0dc00888fac2d6df4c2e","5787f80b5b1591c4837e6c79e1116d2f14f39cd1902dbbba8c759e87c81c4d90","876bca08efc244455cb96bcbab676ce1a19cbe37cc3d007345ed40a799861e4c","58dbd8e5619e1cacef1972133923ab8ccfe52f9b49ffdbadb838bd43f89fa8b3","4618d4091097d3ff39026215c15197b472d81a170d0e7f455d08711b80a1de22","0bf68bd9709c22bd0041033e72c78702d220e7259b1a8a32afe8344eb40c819c","6c192d3d8096ad720e792f314e794f024416667f09a321fb30b09b36a2144288","a178d52aea10afc820da618caf5a00f7ad2e668d78b6dfaa2f4d83a03a3e2e69","de153a9ef363d86e4de1acabd7fd4c86f13da8efda99b2cb6d89ad2b09f319f3","5471e6456a11efd582ba26ad135b34173ba17bf30418dca54a712137d2a1d6f6","e60acc06bbc58ea04b96c703e619e66452b6bfb617c4b0421343a7359b5efc2c","bac53d02b8785c9857c8b5c728d872a2a92a1c7606fabf23898d945bd9ae9e40","b55ee31adaef4e2d3a551ef840ef7c42ab5d3f9476b1eba5cd3df5a4cae72d87","efcede2a75afd136f3ab67f0b185b7a87a709d9dcf27c271774bb37f60eeafe4","dff3f6f1b83e55ba3ec3f7c2c9129268216f8f5207991d44b29418322c0b2cca","4475bbf570c84e336eb53b8946259d6a8802cb3e5725c5f4339c47e3477068ce","b4dfab71ab9549b7b48d423dd0579c75971ff48c4610760da4f6e0c3d5bf62db","b4364dff31c44b9014f2fda4eb97d728982e446e9a235b840e43f94f158c610d","5c8a20945b3beead28e4922e43e435e27c020f434ee0033c3f959a39126b1a56","ad962b982a858491d68acfdbbed2a21740442e4e590449ad36da95e22dd9368f","b686221e8280b203646f289bfa9a6e1d22bd40b4598fe6a3da1076d0e044e090","14267dfb392da08687bb156f4e47ec72635397b39bee25515c373e45092575e0","2a44c9c3aa8c5ef591fe9b32f6603e64c632dce58e52099cc6631cbde7fbcd80","f451b43ec76ba361c0c685b682a2bc9c56ee0a7106685ff8b751701158afe40a","09d8d7a51166783efb11cbe3ed24a883aba992a0a3e3af94ad38ec1c7ee23f32","93c36a6656ac7c37283fa4f9a252f43ff325c0e0c31a73c226a3a0663720ec49","c4693e4df15f7a0e5185a1872b3892e111f02a6e5040725fca5ab22c8b50e441","60133d3f1ca5cc89851ad709aae931fcbc9dcf3a8026dce9f73a759ded0e6d36","0ce0d1274c684a103752d97a2cfb4d8cb68e34702f3b60d40ed069930880a770","14d50a4ddc86ebe39c5d2f7a1086c7f981e12ecbd5059c0c7fdb0cf2d35ace48","5ee59ae26e21e5720156cd797a045646281aa143bcd2ea81639106ebb9402aad","2e69f60056eaf6c1b4e74159c8d7265acfab2a56bf87fe57cd76b8a0b07ed1b4","f6342788facccf4ff79bc90b652cbebb59514de9304f3dee95700ea11308652b","6899594c253faa8cb6979c2c83e558e112f1d1296c96c8f7f058eb70cc320d76","4ac3d047cf85418445e1463364eb2c1ca84eb3b7bfd9d85fdd9a5ab567ade9f3","130924ce6c01db4576bbc8a881b75647306a234eb1fc6a93f75d99a6b77664da","fdb2156be1c85f9702a6443a9a4f580c594603e95d2fbb7b88559040dc64613a","7e8f947a169916002d04f928d8858dd9add0749992e2ef6e8ee9ace4f5871e85","fe6ee344574047ff57c4aa8c4706a7453a8b1ac5419f5a6779a01212afb106e6","a72b4cb4c1a193dd0b336df1098c56ba377b50f9cf72aadb02a81e2567c6b06e","5a7063dd65ceea3c3acaa8b007308b7c1f1f77b570c6239d94ec0080fd259ddd","f485111f2d413dd0c004371deefb6df563d2da0e85504caa784715cd3fae4bb2","6757079b93c83eec58f1d2f43b3154f633bc6f383c353f7b1bba512b58bf3b3a","f9ca9490c37f66d3d26a67abadb7a05a6c4e00d14610c77a04026cef0a9df8c9","92e475dfbddb836cc074ca3fefccdd4de24433caacf19d0fa6ba6f4b3ca5a6ae","010f475c479cb21639e64405e2efb40c6bb4409b29c713091d303e119f34799e","1875d9f92a2e2e44add26f0ec590ebcc3bf46f23064b022757199d3e391e22e9","c4ee83ac3b1d16f13a9f5d251e953fa8387d7203560f33fc623b4d48c6b496c7","7de97effa916979b576d890475494d0216a6305e9a266f6a99a6ef9a8423cb68","92ce763022246165ad0b87e6d992b855b6b51e3d5d685dedcffc8b11f797707e","64582f52f678717bda446ab23fc5925693a82a5d0a00a6816abb4338999c4394","151a0b6a6eb49ff86e4f994d0e468444746f56f6c4fb9a04d7054f54acad4fd4","2e6e15a38c6fe8b624fca13be00a737947a8096fd5620795696b5b63cd7feea4","cc83e0dbf619667f1609c3c1b65bd3b857619f1f924721cc8dfb5b9f8d7435bb","5fcc22822e561f667a1be6cf5ec6742fe35ad67d3a1aa54bf5dc39d8dd737992","37a8515c14f68db66eb5962a3c4a51ff5e2dfde009a15ec0c3bfbde9a9d4ad2e","a65b934f1e669de2c4c4a524757b474a79bc48187e787b80a0c3461e70c82cfe","e83f95035d5b526480e466190c65ef1e8daba04fd0c6a624a4084bcee3794b89","8b8da8f04ab4393435cc5fb1958410b6233f8d05694608aba05d4cdd7e117758","59846f83a0906c37d60cec1a16c831fec96d67fb9e08856dad96065158dd5e55","b47e80ac01359025a03cb64b10791c52cf43585fad38ea041e990782ebfcbb72")
    val is_Bads_v2 = udf[Double, String]{xstr => any_to_double(Bads_v2.contains(xstr))}    
    Trans_ori_df = Trans_ori_df.withColumn("is_Bads_v2", is_Bads_v2(Trans_ori_df("mchnt_cd")))
    tmpdf = Trans_ori_df.groupBy("certid").agg(sum("is_Bads_v2") as "Bads_v2_cnt") 
    tmpdf = tmpdf.select(tmpdf("certid").as("certid_2"), tmpdf("Bads_v2_cnt"))
    count_mcc_df = count_mcc_df.join(tmpdf, count_mcc_df("certid")===tmpdf("certid_2"), "left_outer").drop("certid_2")
    
    val Bads_v3 = Array("002b0bbde66e7623cdff87f6b88dcd75584d608d3a48680cdb8c5a658d1c175a","12c121e7470c86d2179406bfdfc7c19de477cf0dc51f50bab856b10eba941cc7","64a07f85aa6daeb176f4ba7ae359444f319241d4c4556b4486fc65a93cc17040","8f747b0fa65cae803e84adc9fc11c026fdf1c661c31801b3dbe38e65ec972a19","5ce6d684ebcd0ce54a4606756b721e6ded92f9ad583d9d620c67d4e59f3d82f5","b5f5268f5318681a3b6a6b83adcffdee293ed0af900b19fc174ac92f7d5165bb","d87861c1fe45ddb79a8fbbb9c32e21f293d0691712275e6b648fdb27c39975f2","52926672ba8a4ebb2511814c14d17553c5b223adb2de83f359c3361b3a998187","83ef2100c1f68c982387862960d144d4fbfc1c6453d1309c4da8e7a702a62e1d","bb7480c5319e1e3ead73cebd6e7066bd2d06a54699f449b816cbc4f42c35bdbf","7e8ec45d6393ed47b9d7f9bd939e1e6ebd74a9602e4ce78ac6bce768bcfa5374","a9e8ed5e622a019b8f5b8df61076d0a77a403b37f643a5c46963bb6b068a839a","d3119671e6896608f47402d8cb13d36369dec32dd31f0350e3f9e03b0169bb96","e6bf014a2b3bad97ee52144af85df2f0a6b70b81588b67111a62f8d040a1b9b8","ec3889fd96441c20e1151457670ec31d18b7cf37397c944668376701b56b0c26","07f9e1d6af86223cf30587ee376925f21a72e6fddfebd8fcc6a6e8acb7037790","7628660c1117831f69ba6f17c41c7675a629b69bb36548b13e3660829e89c6dd","8b34712ba6ad78ff7fef4298bfbbe78e0c909b16bc42e0fbeb2b356fa147491f","85f2ae8f410082cafa257687a963c48261312122cf0435e50ad3ecf8902af38d","3e3d487bc3a71cbbc121da07a0a5404f7f39584496fcaded81e50d0cbbaa42d0","1eaf119da1c93466afa13a18473b413f615655ae8ff532ec943f04843d04dfef","aa28568a8d427d60692ab44dd6bb03fdc6f24b493bbc5acc926eedf4eb51fda1","497e18af3952c6c093e6e3e6cefff97129c5e1b4c1966923402c82dcb4b11d26","9b7e3a51a24cdeff33f64b4c4c2a6492e22252f1abe86d228c5edc6c4c2def71","43350282bdac5669264524690ef79b496c8e5e21126e8dc59cf17c90f8e3a3fd","de1f7fe34b3a89edee7cb9b4c9c84fc6e2211db68cce43f87a150e17cfda37b8","791b582d8f32c4443ed157d8a9acc67a9b052735ee9653b458c7257f30ae4a18","7783311abc8894cec6723c3fc8a478127c474fb88c94ab8a0d16691a4a5c543c","5f2249d0392cca52b555abdb237d3ef0e6b64476e8a903c318e85a5dd0326caf","62067c47f67ce762548e6aea5ad387654b0df06c3bfbbe3fcb23919dc9ab429e","f09d320824f57cbd8150ba587c7c35fbf9949b9913239ea19cc0124e2aa810d1","1c73b95d5e4763ec0f1403aac7bf8413f28f3acf66c798d3d07679daf8006bb3","27af316e5c1cf5255cd6ebb5f3fc4077d410de5b6ccabff233ee6066bc1b119e","d11f907feb70fc6632575afc78a8b216005e8156c422bb7b14b2094240c81ad3","04e2205dc91958ffa28e2cea042bb2c3fa9b0241cd6eee7c9f7fbbc29b19b697","7e21e1db3617670ef6d4a20f63ead0cfab969cf5854bcf3353c40835ba7845a9","30fb578889fee1e77ee05619917941ddeac53d6b3dda834cdd31ee5499d659b2","cdd1682003c16128f1a7db5ec6ffa29d6acc40b140b8c4c2ae3c7dde977174c3","4fd680d06ae2dcf6d38a7e26acc03029154d63fc5859544aeb55760a40f7a15b","f4fa897d26427670c701e5cc9078fb3d6542c432101ec9d62f145e6168c6bba9","397e990ae173db5b14430a9fb9e7a96ddf0a61fff97eda621768fc728808a323","8172ea75144398a2664d9a9542e8b2b314db9aec896932e9e8a75760fc13b8de","952da551db5df3bddc0c56ffb5f4073c10e4a1e9c0258716d85d23bedd5d8f1f","6f9f84c09a5950e1ea7888f17922a69e5292dcbcb1e682ddfc977a9b4ea1a8c0","a00d29bd56d388c7e9c60013614ccbb96c0f1bb5f6cc98b55b0dc7580eeacef8","7b4d960acfd6be72f653a5976c1262996d06ae952a4d891e680230c4246c58fc","10a3ec0ddf3e1ac7408ed35841531356572b39f5ce79790d870c091b101ebc3c","4f552ce56c52d0c15a10b2663ea55f67ad21cb0a9e81b81beac30ca76b0612bc","1d3ed36ebfba25ca2536bb59f6ae65f764c2a6423213f4c41aab98b8df0fbadc","7305835f85736612d76d6c68bbfdc8cacfca3321be1b2483755f953a3bd018ec","c25237bbc3e207a94e336303ff6b3d4353878c5ceb81b08657ee3d4acb42069b","e6233fd5f6bac438aa59ec60f3e3054441a1d75e76f0f58087f55344589aeeb9","dee689973451842506943d6c549cb8839cf78b2344456fde949c5eb458f16ba7","ee465484f558f4a1ba58e003302976aecc7731b79ff2cee957d7395106daed02","f46ebb7f7d30fc98eaa2118bf12f710e2bb4382c839158624bcc5b555af4a90a","4429644a442af29a9710e829a90d78d3006fee8c320b52351ce26ea0e9536abf","361140df0599c02d7976bd7a571b276c02a43ee5e2926ea91f9c3b355a606b9e","d7f6bdb129108989880be57b7c49e8e5984871b255b3a15cb9b387a59b1c00b1","baaaba7e6c7847c68886d3510a846ea82f74a4371928db4a5381d45a21bed1ba","7f5a311115cf614e405eb9fe8917934308d443aeddd54d026c615adab1261860","775fd2607bd45b99e9084a459f53b6aa46e60865213b7cae69d8879bb4e17663","40873227caa8eba4bbb62ff6eb60fc8742b5cd3ee901e5d4662ffb06112296a7","b84c64333b4446981e58b718382aa41b537a62b82f7b3aef00574d97c24eabba","8890958100d3874eea4f134cee17d1947c90eea0d0a82206f14800aa456b01db","f47b37f0fbb743dc9bef2df437786615bab17fb72bb8c2e59b0d3d3354077062","b60b39b928ee76fd3df586adbe86b1f5ae90e0e6f47daa9158ac4f8894b74fc3","fe4fba2504fdca9085fdd7ccd1606b79666b86833a4b710daecdacc0a1ab9de8","2d6b51815b3c1d3cd5c59d9d90b487306fd9ead40770e24d493f7d9f8ec59fcb","8761912c2fc4cce86448cb9c84aac3db9c2ee6a5fdca912dce8b0d6b996155ba","68499c4cd1d42404196a04efbe6b4b63863c238e8f9f00e5065bf46e856b1ce6","6ee4bfca093a7faa77273ce5e07b1f0caf9b9c4c14763268e49ce7d2f5ccad98","07276071261947ecd380b68e6c737a7fd44b193cb99d89d7a565adaa9a0ca29a","7ecf87f460a4c99c634b6a9b56bda6f5c5c432acff97e865274ce354db768fc2","f0a04bf74afa0a2d017286b702e8635a84f857303230b20e234a2c3383545726","b211e0e4c650de39bb28505fef6c34f47c6181e4c16c16b65fdb603b604212bb","051988cd372eeb40f8181bca84b9fd75ee22d335c5abb5b6399a4236a29b070a","1341cae555a848eccd96d5bf6527d4ee07c158c7cccf2e193b6385fc11980f3d","e15cb9c6866c25bba4de4cf895726e2db04044225f26e7398d6ddf15ac337fd9","46b962b549ccb7fca6efa459c7ef91b88e73eba0aa9b8d3e32f36b1e75438f4c","8474df60dd5928d4ac4ee7785f1ee8b89aa89ae3af974a41f276f24b472d18b1","c28c283b06c332d03f78e0586d1f62499f61252a3863591206a31c1b4b3d0116","0876f7ea23126f47068de566efdf19bab4735da1974c180bcb10c68fd3198ef0","02b61641cb7798c3425c86fb0f7e7457e0496ed1146291d2f2526afdccd07775","8f5e8733b2282c8e2e34bd42e4a4ed355f17dfefee8c3e2ea7d458b20ae8d2a7","6a3945c29f0c3324e728565cbd2c97f4291e7be206936a77e5a8ba2d43cae537","63b5e7935e88c93ee144505bfc10503fd3a504fbbf8158c8ba34ec351933bc41","f736fb86da25663a14a2d6c25143b2fa760dee1216d50d23ac8667fb86398341","872f13c0c369dcb847a570e1cbd58148181d4193a5d8d15ec865bd74492c679e","513fa1e5370be795b03adc0724da38057b3ada4e866422d963b8b175409a2e5a","b3eff232edf2ddcd00227fe17a0e80d91260451e7dad451e78cb7e4c01c1e4a9","ced55ee1f1d2ede22659a821fcfdc18e1772cee6ad3a0b01b017e7b14142f1c9","230a4c4841b7994ee72f0e550ff1d8dbc537c4cb947ba332a27eef0a867eb2a9","774d8d4190ceaef083539dba8f1487203adfd03da0ae825c141da116d5f4e2ef","722964e5d18fda3005dae2d4c66656db9c7e5da357477eaa7ef857f28781c8b8","933b526aaaf224bbd123af19f1e206b94c450a92033db82f35ae7f06b812da90","93f4160e559e2c128b1b60ac893420eae76d82579c0241c200059f5da37ef588","a2b9e9fca118eb129b19d533df55edcf90f12817d83e106a501f60573e92e262","ee017286167897ce315ea11096c1f798e3d68161be12aa07619fff1bb6e2e2b7","8957c9792cd06364fcb07189ccda5a1fc561ab57580eac9c54e4f7de415409a8","0fc10e8ff1dc115a41ab395ff840dbdd406d689579167de1068b45f52862a32a","fe5d04e07ad8d457cc39af27d82fe0c12713eaf7cfd42a35fa74240e4df582df","9811c6fada00681afd5f93743fa9ef16522ec55b5897b6b6fe6f5cdfe41ca8f4","be0a5bce6164a86c8e33deb2fdf77b8d89164333768fd3f2e6bb4c75a3d08d85","b961652ee8e452350462ece038e7960d5fb4a780021957596245caeed8302f5e","246d161fc21f7beed856b3888c99a32504b2cbfe82112b5f800af9ad4f9317fd","5206fa3fd2160219b2a6a6e3c1d17f99857d0c28de74f08aad0c7278597e058e","61a2f8c2fad6547d06573d0ec1361f803519c72e4aa0504abc5996dd24fe738b","351dbb04adb144e66a523318f82ec2077e169eeef9314f00ef6f0c8b44a309ac","c37fd5582393747ef03b83ad095a5650d2f5335acc65eaa7db54c4b2a21d1092","9cbf6f256f2bc7b7ea36d78771b700674552d66f2e1f19690aef85fed943d7af","9f4d8e6f15196fcde3c12b455f410382ebbf6cc6a662a0ce4414bbe4172d71d6","f742b78c8725b16105e8a8f02afba4e9f4933d98b526bafdcb17dfb16d6f74b9","f40200518831f99ca212ba3b0d380fcad610b98a801750e31ff9733450a3fc48","82c8a599d13364f737995dee44e473f33628cd2863d4e4fd8e350911c2946587","9dfc9a298eb5140ad46c74d7c50fa928443c1fe094eb5ddc13f758deea204a27","a026e1b25d1d2d16dd58f679f4c1ca11661e66aeeb0d90759a0f542706adaebc","399f7fb6cc04784e9d8f28da99ec8bd671ff567be180b446bca46c302be4bd3c","d9a316200087f2da32c4935f60ef55ed271701e374e319eb148ef9d3cc96908e","5690ca84ec5da1d4c9d3164e491b0b7c58738fb6da525b695f1496fbd2d1c395","bdc6acff046f068f417804d9cbe60fd488cbb0da13b7c309db293c1c1196492a","82156b7043878c411b52d5933c6528f04d397060d257e9626df01b8e078852c9","5d659c755c59f23d01afe506c7c3ce1d01aa25fd5d11f290732400672fadb578","af8ab1d2faf9e8b9b719ff143029ff45a8978b074814a545c7a85af3353e4651","6ad13c435d7c110984bd2f640964e0e7c6b3a1bc67731d7951e6770edceee5b6","dc9d08f05387876097e5bf8bc0f4b86ea372b0c02e3ebdd509740826bdbf5ff4","fb875b87889c1646dc4ffe1420b31895b35be25372cff5f646014761192fda69","7cbb48324a001cec744293ae6f73bd1f2e596252f9be29fc236fd909464edf50","f94f0c2fc9427c0f25600df0db33d326392e7e742ab0531facea09292d6e467f","e0db8769cb304f63377ed6d581df208c87242ac176a46940c124efeda53ad1f6","9a99cdcea8487e223926459ea978d3c7f117020d82e52b81c91d01778c7d5bd2","d6919a1a1eb1aa1918d31c56dee48dd9d26258f4488752c8c04f441cf342ed75","ae0185513b10e135206f39f6eaa54687a49e8bbaa2a382a13c4bafadc114b7fe","6f3a349f175318677b3f2333833a95a9a671decbf924dc42f29868d401add606","54cf137bd26a0288ce1b87fa493da9fdc5ef8ac99a6df96b4122c38ff6afd547","ca42b5a1a99eff022eff58db0ecf92bef758c30c459a2ab9697fa1cb5b32c1da","c1d9f1295bd1affe3a31e8fe2f34e2a73d6ef7f2956351b2ffe6390b3d008a17","cdbb328a3c83607cbf5f226d8c492c2446f45657c73a8aab44c0fed16291efaf","12e7280b9797ec90a9b510c225bce0409774b50bacc98460da18357b97a7c1f8","fe757fa9fe339b7473d59b31eea37122f57a997524d672491062d4ad27dc49c1","858e3d722b70c2b089c557c6990c940d4ec605bde5701ed4195b56d7cab8e238","cae6ae21ab85db2d8712470cf34fdf7d4414d8dd62e237af7394dd1572b4b4e1","336a980727cb0ff55a955a655dc377665e49a203ac56952466abb8b2361ed484","0f8442dce879e7ba8e9eb14e67db285396f82b58826b72c74c79e8f92eca25a7","3a976c6728da3dc672c8a50c7647c48d280eb9417b1b0446bcf80877de2102ec","dbb437a6d0ca82e24445fb3f9cc4a512de38db27d8699cec1dc3464e1507fa30","558c6d6f9b9115e2b64fb6831c95f4e2824a5f1047b874e1ddd31db18d8f829d","f6bf47ebd31db655707b421cbdba06e5369cfd14027748349edc6403f9bb6cfb","52c4cc1b8b609890a8eb2ee105db169a2209c1da2ad296a156abc2cf765510dc","022c4639464a35fdd97fe322bac04b2ce819017aac412d4a386f3d9ab9f95560","0cc09214bbcca8561acfbacba7f1a962cdeb920dbea9bcdfe85680b10f28bd63","032c3a51cc162d651575d47d66c13045d7064f1ac462cbffe3da68e79694a7c8","02d0496111ca8cf7ec0b2e7f9e01946e907b5213f2f0bef8f0ab17409192f463","ba5757bed9ed726958353877d55e312889ce0ba72fac232d305d4ae009feb8c9","d9104758d731fc68278d3929b736d2dc4bb2afb54a56dd35399bcd2880286678","20bc2e7f55f45252a66d9ae82c5081fe2370ebe940e9169640febc543ac7f0e6","92f1d2ab6ae679c6b847e96062a03a46b0ea191856c129ec78b78f495e7db5ed","94789b5de68db51ce0ec3e7a9b87ba5867512aaf778d6bf6ebbe21d6dac9fa20","a86bf7bfa6b9cecf0155499c52d2292f9da1236afce129a3348ead5014085545","6c8c7d742dc12a6d50b2c678473ad17f7a6918725f7dc9e4e8faeb6776d7d852","0637401cb8aeebe248bd4ca6e2cfe092b6cacfa4cfe4ab4755cf823418c45e83","55374b6a9144514e25c853dfb6564f66e93c1995a0d8bd8b63eabc764a091972","4b8af935f8c4b9bc2280b0cfc2353a049b62d1cf45c5fe1835b06b582606d039","fa7def6114cd9b0f9f3db643aeb7cb46e3462adcdfb910157be44ec978f6bcb5","62937c621e63d781bfa80a3d9a61bbc152f3ae5fff1a84cd52bf702ab2db52fb","3026656b833f956575812e5bd4eef1e2bf9b3e4235a8f4738020d2e3d61ea6c7","cb1b416ee55d1ab0ebcf674d7cef52d66bf403e52c34b2d7c8699d9c0b297f53","8dc83e9edf0b3a1d639492db2304e1cfc64be077ce8dff5452f1cc981a6bfc35","2c8d88781b70c9527bc36fec30b15fe9cff4e25987cf62a9221a4deed8ee5523","6dc47b43c75e28fe9eecfcb1cb183cb113733fb38de8b95278e4fafc2e665a04","af3b86bd2ab075dfe922a0489d9ce4c9e6de4a4b7d401081764077742fdf6152","55401ef37da8561b32eb307ca2fa2aa2a990085b3dc656d08c10c7536a766f69","7b7e145bc5b034dd723705bbcfe8109508e2a719af3b33e80602d5330d886c0e","fde071c98cb68f4ba664aec2a4dabbdf5a6bf39f269d58a321b2e50a4bd3897c","a37a17dc5ff90ef5f8cdfd07fb92cbb8f9d193126c2f568ad4e6e2634667a871","8d3afeecf111a41cc408952d56b723ff79571cb58e465e5aa75b96cdbd0ef176","1e0578d2b68ce6c967b2568bc707ad25ea9c1bd30d845986ff283f4bb6fa114e","d61b63f27bfcd49c82484071beff7cecba84d808aab1c137e3c712df2d17a38c","50ab768cbdaa63da3f68ebca1010b547cdca19a1f528a8828e015f8d980497dd","f8d9bd5fa7c89e3e9ba27ab57d95f0e58f170e97bf5b26d5ca3a4e8ad2cdf77c","7f19d19159838b1ed6af628f8a3400c7d0a9677f06e4d18ea1544131e4a52348","700ba8d9e93e88141dbce481d2a17cf983320fbb76ce427aedd1fc0b0c17b19c","5cea0089722bc718a93983f8dbe2f468bfebcb5172e2d7bf9cc5934b9a9fb345","f1bac5140c6254b33411e3be253bc07abf93143db68072151026e53356e4e21f","93c4bce3b3b2b90b623d10ccf94fa85e1ebb331aecf9e3dc89eb4a71601e97d5","57abe9d0e4a554dab6db7e359e38e405d50caab6f012413d402740ce671481ab","aaf768d5775c819cf028c179383d1925bd41c95d21555d511bcb5d88699d71a5","d836a7b8f1fe54272fe7b6ba460cea702f56f385a74b0dc5999ebfb740090ad5","dc89c844fe386b1754c40856cd10e3412799640d956ecd835addfd395dccbf95","2bdf645b47e8b73d4c259947e084b4fc15a425e04c3737546c228f481d89f952","20a4d0369cddb46ed3cae7419b0f886c90cad2f7e945c01a75ad5bc10e799174","a08bf59f95353bce36f62ab9b3f32d446967dd89e7b05a52e7e60178e32b60b7","15fe61fbc6fe0521b5a8133129a69967818def9d83924318ed13547969d0a921","e5113689f3d5d7f8d4277110a6c76cbfe2440b70adae2cd1ac49b91746265e34","34420aa3ac09761025a0d43e743bc375b7b42dd962a1bcf28e38e3362d0d1080","6b9e7a99e2985670572ea32d6b302cbe134a17a48ef4bc5f3eb648b76e65af20","07270a2d071f791bd2b0fb0a63ef4d5dfeae26dada9923b3a92e2967ca032c5e","a79479acae049b253504c673a228e5d5243c8f0c5b6917ef70e29630c51fcbcb","6d0d04d378cd3dd8bea3639b9dee95b67c77b90a6c5b39f94dae75d7bea07344","ce488b399a8996182d8de353ad8243bc08627d48ad9856452c323ef42d80e728","6799c1eddecbc56c269324897d34e84426e9e199075c77f06507a88d90822423","cf6c32d0b68dd1d9bde59d3005b7686256fe2fd2683c81b0fc9d0f1622b72c14","f792f23619dc13594bca9d63ba7b24ef89042b0256e16f963ff6092ba1f026a3","b7b848eef91c8a862e9395bd82d3414278011a20cba6bfeec884169d7374df26","ee0b271d34d4e4131be09313a9eaea7976df3066599c97a4c4ad021312596f00","c7698a92516e7e6cd40ad8c8bd96b1075935016cd8c847ed85c52f3eb9e31ae0","6b589a09213b01dd3392faa10f6cfacd35f9b591e485785f86f3517d92d29ee5","3ea4802381487da51f86cd5637728ecf473b8b36d88645f0744d39dc9dc49571","67d96ef77d05c63dcd7e5e874fe33cfcc454d0394965f8bef6b51ec8d4b5158d","65ff8c3f83498fe8f1e1bc68b6f4bcedd4e60119a23f6a12121c4f04d82fb075","d237df673a84b98750e8a98934a705b7cb50a09da743d4057294af51e46b56a9","79b12967d2794d06432856742e49af14d2faf2c6e7fe08ae1298f45be121b307","8dbff004024a6f6687b2357ac1948c3ad6d7f2c16c81ac50844e62ec0c3ba766","16820902bfcb41a52fddca000f17c996097ea109ea55ef83a4470aaaba650e54","f6e75a3ae95e4c34a4d3de0123b369fdd91b0c4b6fc730195896d509b548d98f","467c3a0aa36df52e3cf248180e5bb217ba5f17e4f22364d97a97ef86eaddc34a","a5a9974aea0a241d066537abd7c5df2962aa615dca27cfcacac5671094356f9f","ccbe47e8ea8a0331af41d5a009eb181acb4650dbce022ee13285f2bfdfb5c749","d2cd2796bbd1d486874de1ca19e43f99002cb84d052b77b55c2e6adbfc819b44","89beaf147ecfa0f45ab3c198cea3e5f2e412b494e64bc141fec8e6f29bf81042","bf762867f503a0a4bb016f275916c4002e815d0c6aca593035945fa42b73a192","6cfaa00641d1fe2dde13a3767cf5bb1f69f8d2d73730f24677be82caa786d344","27e619aecdedb13cef2963298d80739394cfab5a066c6655b7f0c3ed9af59130","812a1e7123f491cbd98f068a8a57db03e7fa4972b692a7127670b145a951295d","3862a79a67e967b05922b0067caf4bd7f4e6f55f0bc03a0620bc38156c4d006e","330786f1db0a4a9966d1b36b205b5f54507feea6f928686c08774adc7c7ff7f1","40aa19e79d327ed5ef0415bd2bdd2b3f49e56a5859cba81ebd2dae8c1d000dcf","8e45b03468c1789723c05aeb1eca0664b350d807e8242609b6fdaad343c81555","e4175b2a7f1cc59f1f9e21749e10c3b0dfe6f4e551bcfcf94fdff6fe1d7dfa81","7644af36113f742815955de09521f7d59ace74185ddb8c31bbac1a1543309022","0ebba5efb81caa8c211fdc068065bf3eb45949bcb8834d977a9266ffa771107b","b030d68228ef5723c2b3334d5270895afd479137027a30b8596664d55284a93a","e3974baf5fb9564a59db1c82167c69202b866028ddcab54e147befe1d5f675b3","8c1c75307714720d1b26ebcec8e9a5dae49f963ec1dd843abd4d0675ea4c4c64","86ede3cd579d07bb0c06c4a363fa10abfd44ac57391dcf8f2b1d9d2243d8d75b","a1410807131fb4b0ea19c6242e20324904423a0abe7f56bcb97bc58a16924a67","de28c9eaf231a95bf47c51807da00573460a1b33f0c8ec8e638f00ddd7864fd9","e581586e09b8b90880f43f5a9002baec37ce8c8fe232d3308f652e511c4e002d","8ebb19ffcc9bf2500cf696a48553587268bb119905c700480865be36455d8592","88a5770d5967cd4a1897ae01a61d1e705800c60831984d22d696879bcdcf79f4","778404583d5cfb5fc54ec40516dc7db6a0ad7e510c87384beed6f220d172090d","070518ca21bc330221ac262250220bec332a670588af2f2e676b1da9b1734134","ed016da3cf4a09be8190a94a4366ed5bb1b14f3f909c5ec97aebbff7e7fea745","24c16d1d854c9d07b5b7b8318c5f40815fc5051a43373b20b6a13eda3bed6afd","0653361ce573b94ed101e724e5733ede7960837c83b2355e08744ebdb9ba2569","5492ab4af482b41f9ba37225b5ec09704db9f4ff281393f0ee98d3586d6f1afa","5d2429c2bc35f28fd99ec1a1b1773eda85abf7860590f71638b0563c648afe66","3971c6977299acbafa5addd52663dddb42d0989bb17043f842f8f02a5e6fa8d4","8a8299794f69356bb1bb20f18b83176d10940262194369f33082342f365dd60c","b8872196708bd31d8df22d426b5bee04d19a43610a2ea7e596cc76f0cea3190c","fab35c3e19721ee3b252ffcf904fe91b5931f57f5a3930cbc1d04d452a60f4c9","63cb69a6c2c9e722fe1f145032dc5ca29dec316e52f1cc61dc04dd41ec227493","ceecc9890363279638bc56452e385daa2fc07c1d38b23f63d5b345294c6d7379","05f8764e470d993fbb095164f401a4a89c87612f08506b7eab09b860138f150e","70b40544a7dfca3d7a567c0ca02622c69cd11510aa0605c54863b2c8996603ca","a15cde9601b7cf5ca015d7ad7e5428694e1a92c810e3daa106e3057610bbf2be","cf7f11c54a7609a1ba870553e67daeb8e7bfab954ec4abbe496d7e5cc0b79a5b","a880650432687391875a5bb6b3ee9d18d0c63ae50ffcfeb2e215c41b01d9170c","08abc952f3b40586f5863e0af323ef1af61e6c8d780dde817c5e2ee4cb64ae14","0fd74e5e0f65031f810cdb49f0857352c3e60ca5ace3a8466e220c0586324e97","aa06252f987442e91ab67296de8e2fea9cdeac07123eaf2661bef11574bdb9b5","1fd14bfe715d5e19562522fda32da96461b28155f6486af169fcc8fdcaec959e","1d7e07c040998a995ca810561d0f7f01fafb5a50440e9c104a52d495d0a1d195","10885e04f6bf872ad486a6183415ab7b6c54b4d900811617bb8ca82be544a9db","592d644646d38afaac84d4cd372dddf93e958c010e2b8322ea20ed38098d951f","28dcf847849e5d4efdf5c4a4d655dafd86a2be95e658e8e2b12a3e21829fceed","6766b14d85a7271e7e5074d8731e185d6b608dfd1b90738feefb4bb4b2f25b5c","b2783229a6dedcdc472e01d9329f729999a0b036c521d4c4867aa763e56beba6","6e87d1947bbe5d775f927945c3b1da9bec129f8ac9727229d5603ae8ceae170c","82440b19044e852f04c7cd4b80c3c178a4084ccf6424394238aa0487a356e8e9","9a7b55f4f3e3bc7a6253d2f1a26c1ded4c8e8bd58837dd9a2fec98fe1ab1d0f5","82543051402270686157538916c3213901128ac06499442ef887c5ad5b1123d2","cfea58c55524599e1d6efd102d7bd842e490079c7bd53fd3b96814d79eb92507","a8809e3687464d92998f71b81fb4221fe57712e3da651247328ff9b27f4e7f1a","df936119b4543c7af155937d2272bf5a0fb295e5699da07ba3043a0f1dab41ca","31c2cc2075d93cf9f6fa1b9456b3aaccf2f9f88abb4a83431f1dd47ed3eea2be","4c159e574663ba7bc7cad66a47baab721ce38973df1c239852adbe1b2dc09183","98c588d8145d306eba00898366abf69afcd719b90d98c336397efcf78cc4279b","3a6545374fb0e2ba54979fca0d266c183480a2666f3252e8f2d31781827cf3c3","17887abe7c89d04dd8a51653640d661ea01c9a421d65d9110f917b90864bd0b5","bb5f29246090c9f18406f3425a71d3e1dd0f4078572cbbacdffe51e469ce041c","bdbaa8e56f14822a4b3bc8e54ce72f733360259d520e7f77e9f26a209e997ccf","0ead738e7a042fd1347f13c895173c42a93f5ea496f053fef90a7efa15e5ae96","b5b734118de514730a113b7b2087dd84ee5b3fa0146cd9a6a858166f490c41c8","dfe13add0fb6dce36fa1b9cd0821d2de8f8833a35ee9e032449a796017bffb93","e0d3fb5cd42ae22a420cfad9c66030a88f213f6adaf6ed57c0232430a1c46748","5b575bd9735a14f0891a0844e6c5a457f32b9746b4ca2ef2969452864e27b303","10d9808202effbed004f4129b634c7431eb88f665e50fa0f0a7e65693de08938","177c3d628c811627a6aa240eabf87efbc8710f291ec786a2c702becc801b443f","214f4934b27156b955f3dcebc3b0cea32ffd61e9f19ee92f2af37168835ee6c8","ae30b738ce733e62a3c1ad4e1e28633e4fdc7ee5e30236d4a99abcd5ee31a92b","41bc9700a1a6201f084332d30323c7433ec9b8ff7043956d51a0e16e6cffe53c","a51b9d29c320e399632ab9c6b8ba2d6b24a9f4112bad256a56d204767471439e","9a525ffad249385f6016bf22720c7f6ad0a011cd92fe4655d412fb43a3c9328b","20f7e338e7161dd58144a271bfbb0fdb4b5aa1132f981b702cac61f64db2464d","28174fdf8ed2b6affa76d29d66ac76487b43242a9d39c97740e17e2e7d559b77","9f07532785c7a5e3a1d96b7abe94e35559f1bd3df43b0e4711c2cd02aa852241","672f294fc4ca9488ec8cd0bd53c3c1cb98311b7febc64b94e2b0ea797b17c73f","45b0936a36a109e26c0281d2235086843af17257f27f6d5bdb26400657d0ca60","5e3ae6287d780ff2c47658535c6e98ebbdf422ce756a6d889dd35fc57d68830b","cfc2b5a934ed8a9acfe504271c86c0769ca3b06dcbf95d1bcc74ef089ae75a66","c2882ddc37981423e2a8d0de3ec2efb8bb42427cdbce15874ab5185e9e080e54","0674d890b96008bb7eaeb68905af17c9901ce60c92d2505a13c3ace334a23d10","f933519432adde754c4737a2145c93ad118997d5a1eb8b3e4f235a4ca6740199","955aa6b06d5e8dd97eb9c90b05a5df3eadf20755891c43a2a9f6db8e40d1b7d8","65adf21e89bbcfe8758f7802df55fd9cd7390edebaa4b60f2e9b6eb4a6986f04","5af8c1041fbe36966aae59bf92bc07deafdd089967e914ce157c7617d7dc5c1b","395c0fe0839a20222a737fe95cc8e1103c21e4271974b5500fcb43ab8abce35d","e95d5009bc8f16a7a8b5fd016615475c45e61095b75f4e32b6a9eb8ca0614a6a","f52cc6b0c684651281f6272ebc491658159e76aa347c06fccf7693eb4a3c6036","c17f88deaf9055d8a5676b319121f330920a733eada0d6069acfb1c731fb6d2e","e85ee12bac11a5af640d97875f7404a0ccb24b3c9387eb541bcf7cd523845d89","64e3cf9328f2b6fb0d0766b9ffe201a6d41c4b1b57eb05592a50ba844ad41e0f","8ee1d3704408c9f5ea043301df23f505e42bc06ead2788fe83f6aa3e4cc8fdcc","d3ad35d2e700e5cd5d58dfd55fc8a67df9550b8c62c9f2f8285110ba6151c2bf","521cf24d6708d8b35d2216c0d2cd4be1f5d7ee5e0309158b478e97276a995d58","48fcb0c3e0b3d3cb7f989e71d4eb6c90f2f7922b6a30fb42a0bbfcc97e1f396a","81ab3f1b2c946de52710075e6d6b5b35a878945d8544eaf7a535deb3d8bdfdc6","6827904d4546f5be60ff4d375d338630cd08194e328114028a212e2242ed04f4","83c28dd01e4f453d8c2d000dc9b35d06c0ce4835e1c0e903a9906f25c9941270","7a677b4539372792b22a3d9072aa58472978958d6772fd442eb7e00b6384859e","04750b5ceb060c45978cdbd0292a60e82cc5b9abf10ca2de64b1e5b58d79b61e","dd8836ccfc88f7ef75037a38f41342339a04fafe887ee692210ffe6552430a56","57d464a611520a472d104459a4d933758d2008e3e1ce1608bdd7d675d9ec73a2","a8affa61c2cb34dc130b6e84aa229bf0474ea51b99d8a162bde37e43f1cf4f1c","852324dc163a4b4df859876c77ff7b29d6c5021d4a42ea0481691860f841df0b","4eb6b4c2e63f6be0a9f9724d64889ccc21a4867191a61aaeaebc1b2b0d4a4851","10498fc6d42edc9eea9a20584c36853a2d997dd59dad8cb224f0f7eaf033c13d","5e32a5a216fb0ca123af1057ea388db95866c9418177d14d227a43187de2639c","083285c5168c13071739f0fe4c44d7c20d431331739b67a2806b3dbfe5bf0882","e244308bc291c8471aba26a4eddde75e31469363f67789b35bfb1cc699ddbeb1","3e309654caa4b2a06de057dc011c6b4c9efb9241b1eb187356e2f76532921783","5696bcbd22cd94fa1527fbd7b81c84083a4d1930a5dc31bb78f19d35a07096e8","5da0e8d523273ccd43ab42fbfd32cffd0415e1be3ab1ff172fc4d3b2332709b7","c7d9893f99c6ec9fe3c0c14fbf1d53703e133cad4862510bc6eaa3dee21ff837","231183dcbb1114dc17db44d7f81805d9f124cab63bc335568eeec77524f64e04","7beba2135c1f5d46877778ab1ac85160edbacab4fa2b25779a503b44252a0672","b890186c7f552537b08d5a16e051010a55da04b4f50a84d78ccb157fb925d38d","13b7994fae9387c2e1b598524ba1204ae404d02fa67016ed86c74183ab1aafca","57a4eb42fad49011219cc26780efb71163f61e64798039f7fc9043a526cdc24f","d5a9d8594f1f071a264087f259d2aa3bbbac21f1bb6232d1395814ad3a99177e","2eac393634b4ee46dd2995f50fbac6ba89bddeabb0c768f58a6d17e822e2943e","949a07815c50558870b8c27410283c5a1acafd5d9bcbbbd5c2e6e942be8e903d","d4c1f50be4ea8f350cd285bf078e52081e35e885d7334361e192bc50086fae55","16c40cfbdb4fb04220551193f5762355d8e2654fde15c09548ce2cd74406c042","9b8a455a2f609fd4d03a49227b2ed9e81e8307968c35260f2f7720dd8f2ae2f6","d941f8b45e2fc28b3b5861d525f364f2e2952747804e35466e848dbe3663f58f","2a81090b9632ff0d7124fc21810f9eef6e53c218e5c22fa6d86d653cc9a41c74","94aaea90836d5983b6ebdf24f0ebd689b4bf93512da042affb120669839599f3","15cdbac3f37267866ef9642e650df3446df45a6fbf960278f8eb7d62658d9b71","634c5bf66a1858f8e4cfcd0272bd5f32e1d696a255497cc25fe00c61ffebb2a4","154702081ebe50c4ece6fd8ccef32e1f8e537d5b835c0a0b7420f1971f06acf2","e7095242211c9bb726153963aaddded29180e982cc4ec399baa64815f3e92028","848884ec546bbf261a35162dac1b9062b2ce755e39901cdebc472ed8c8254d1d","fc9da6e0d527b69611f431378802cd6fef1dd0e7d7f7c151ce7eb54dbb72e337","886bbef6a787107fbd0a2b44981cee65affbbc3aea2a1f7e7a7786a439068b44","b38db8e77ccef63828714c3bf385a887df126f1fd23cdbc2c4ad6e08e89a4f9e","dcf7776480266c581006bbfabde2ea5d78651829a7381567d37087d4a61ce83c","9ada96649235f04b2a28e0b0205bcf5eb48224f41ae63d499e53aef9ff44d892","49a530db91670d481ef6476531bb75be4c147931c75b473fb2272a2994d90e02","dcd3e72eb9276222d4b9c73a22a557ee5c3eb32d6c72a771a87f9ff95a396ad0","337bd7d72cd418584ec57f855eb3d72a82372f0ef6f8b1f0627343cd94536653","fa8f30ea59912fd7907e27d803ba169c45cfb1ee9efbd49fdb0892eb69bff24d","f9bbc8e583b353f264a9212019301e4de5d87e258ab49e4c1a1bdbc213f25517","e06f284c8083595afbf3dfd9d2e4e10401070ddea88d5e88f9dcba5f5adf7f63","f7de27a67dbc3a77da4d5bdfd38c55dd156093ec25e2fd6cd95c7854ef0c7202","e419265b1ed3b05695cbf1b2e9b4bb1bdea54b010108e4cd3be3098d92d93f68","732428a410f0a2f1a1849c9892acb43ff9eb099a0c447592786598e4b4514c2d","59547f264807848a1e36c5a67d94aaf395b097a5c70a08135351d669c27969f1","14f967572a82d3ec5965cb165b1a708307ed3a6d3b1eb41d9a99caf819bbddcd","40e3a6f055ab8086684551fb3420ace33972ea5b83c8ddcfee6313ccfc429323","8199028f9ee0c11eadb42ce01aa765d704ee30e823a9d2393042e5483d8f2e95","ac7fb176a1fcf5c76b3c2af6b2481b96f99f305ec05a0a95a2b9f64438be8b72","759bbc81f28f218b0102674bc3aab2adc43332ac4fa5c3be4af377873888cdda","2e287197bd8126e0391c775f49600e351aedf7f2344974342e9e5e4c8e4280fa","844335a87ca7ca9dcd0e556cc85c3e8f861ebbbec77d8e7ad4fd626a53d20602","8725b9e4e501d66e2a34b0029f265d101052c81f4ed14abc7fccf57fa477de3d","51f359163dc94d2f950e4ca3cf9f5592c1a70a379b9643179094eb31dfafaff0","cad457d32bd610e52fb14ab91feeba49527e679888ed2b1584287cac59ecfef7","ddab320be5490585e74f78bebb7254bbbefb56ed3739a0b168b6eee32901a804","da97af616f62caaf4a13b7c59a616da506a7651a100eef5e9e81d1bcc7544404","462efb772852ec31022420c593a0eae2c081fc6a74201e2b3884ca27aa3be245","f16811c3086d2ac752ce35b278581d16f585b9cd53cb3772941d6e24ad79cc65","5090c0e2caf75a8b60d6e0309798115931ed6138e9d71193ac23bdb57675327e","4b73a8c3cdd30b7b526d8cd0d61e8bc8414019cb0293bd066b4df89d16d7f73c","932dba3c78dc1484eee461adcdd7d2f151833c2e170ca9302c06bdb41460b89c","378a30ca6ce22e4fc9cd99942052780c03db6895d1706f1edbba7b533f5be0ea","66eea363c44ee9d4a892319dd8a0b2c60677f067a6483b138a627e76398285c4","3a54d91324a9fcb4355cfc143bd249f0f28be42ef1d5548c03f0b196e8d894bc","546f00646712b8eda67091210982758b0f5bb3126ff0bfa6e4c9021608006d57","827e550b2e9e3d0b0936d91818296c958e2f03d3ddb62826a1445a8aee772788","1592f31edcf518ec643d89a0aa3b39b2acc5229b16f535ea74e0cea334477931","8ab6b9bdb54b7956d1375955db6909c2b7db3dd423caf223208d5ebbd3c44d56","23aba3246fb80b8d90cc4f6f22a6455e5696435cf42e91da5c93afcf73d9c249","428e677ccfb68230008815bf5549f89c709611625dca34d83e40169bd68f9b8f","8462987fe4638f71015b856db6f8fa448ecf485c07323ec2b56faa2b6a20ddd5","e8b7989f8ee9fe2b739b6e63d70c9763d08753e491240489aa669c25df6facbc","97af3fdec406023cebccf7e84876a325c0e237cfaebd0901b27354d722590089","91e09caff47ffa1af6af098dd8def73f277c2e0bc7cb1d8f60e14f646dd192b8","f66d2b7ec9c44d79ace06f3e96b1c93ee70902397fa3d11f8c3a988ca075604c","bb099e71ebfffd826eaf634229b2f70319fb509e6ea8bd4bacee3be14a796802","9bc0446d9b7953e8ec6b0fb6a6a6ba64d607078ed3ceaa94eb747532e64d8c1b","1bddaa23cc182572188c4eb288081e50375366d93d180943ff8d1966b55e7c54","a0fb08b6d4e915a2df0bd8c017b7ef8c48b6ab5cf4b957b7050068acf2f3f10e","b15ec282609fd2e210785bfbb4d38a0ff7e9d796f0967823cd5d8b20d6fccba7","dac83569076393437b2e4438e9e793bde8be182ff4730e0fd06f7f1c11760888","6340ff96344b85a462aecd459a36e21cc33d62a2a2b4e1e995c4c44eae01a81a","ea40e5d985eb566e0fcc3151a682ffea588832e2f7c8ef6dde785902fedbcb30","d41f70f393539efc5a2524bd4e03e4242ee898a4e751efa91f492bb7eb016048","cc9556b17b05b6bce575ada441d7e8f04d4227a7f6eed9a2cfcb80ae69491fb5","27817853047b305ebbf4de504e28a3f1c11f0c9e76dd44de8ae6efc82c2a13ae","8fe670d409dd8eee7dc976ea5d20954c10363cb052b90b76e6755c0c13574bd1","895182ca787aeca1ec31764bcb3a722ce8251de3b718a50b935b95ed53b2d0e9","b496f57f0ceb4b35ddf6e7fb3b857180f1ae9a81e2ec57559e445ff965770719","a1d3a137274a8c410985cd16abfa3dd2cf400996f0d1d636546d2b8036d9f4a6","c2871af5c323e11d5cb6bc807b2e4b678788810e7c9202513d5820df422ad92c","018e5bea28634238e53cd51c2668caf7262c358961baa839d8bd96a998db48c7","53ba5cc826bce74a493506f5ce8e17a5aa5d1d189fc0d9e56c08942d3825739a","d3236cb1044c68ad27eafd74502db6343b85c7d1847491ef037ed5f0a730c719","079dd5e67ff10e6ca560b194383f89455704d3be5d890daece709db976f01bbc","73352dbe01eaf5e063590356fca278158488377671555cb85a230d504a7b78d7","76748a37524d6d519e00a133e61bf4d95deadb14353a08919d8bac78099fcb34","3d33c40e6c0e2c729fd12b16cf67ce8cfa25ba79b6c43639b214069a04abe847","22536f195cd1cf0e13ebc58d6741a4a2c8613280da08f2b1011c255cc28726ad","4a6d465a78fb50164b647cb45095c83c7aae425089c2527c6c22d9792bd8b520","ee9848c05e293e581cbe98286898cbf8500bb783da083394845d2a3436cf4e88","dfaf9c0810c48ce3432483b844fde27fce3276740f3e892cfda77b8342374582","a3a939b81c1b426823465d4b8853962b0e4c6a28c4f50ad850eb820175f717d0","c19750cf25c7945309878dda5bbd1fde969adefe5cc1d6e6528e557b7c887fa8","2fdc6771a8af981b2fd3879a0462b515d186a14d747104d81718b796477d3d45","90e43abfbf3d550076b5709b6385ee99ce1314307480e0a5eb5319605e90318c","8819131296f9ad223cbbe8b7ad77c6f6c4ef5e72ce7250c5e2343b6570efd483","7560be90044dccb335845cd1531ee05b2ebea59f90e1a513c5047c04dece1887","df19675175aed21c29647ec32174709d2060cb76600a5423fb0af49932a9b5bc","4c1bda4f77d7555689bff254b987828296a18bad9d4617631dc78712a8125888","1aee6535e871c201f94f68e214a772261f73711f26a25d919462a50105a75164","e685a0f0a62cd1a89f41ee02735a865eeaaf148954180d8913004836997cdf0f","9431fce5ab3e3c7fbad1b106ff5cf1e0f91d3b5d98dc8c39ebee2e239897335f","508bc29e79ddd48cc9a2bc04654c55dfff6e4c83a75e067737ddc31b9fb41bd9","5d40e417ccc13ddd024d173ebe5fe2a831913f705705ad8160a36e568931585f","2873fd8af9d920d10184187f4e24a8aa8da1af7ce406f77f4474266615709735","2c3e80bce48a23e2babfb4151f93239e144948b026bdf9b1da1ac32715eafd75","099f8c90064ff3a4fab5e65a2a0b04974514009a0c29a0b74bb1850148e579d4","cd9a9496db9364a42b83c88a1916a608b834e33e16dc13a9979f451104e47560","91af43ca1e153091a4c84e98639e95243598e17f57c6acce5915f6a90fa413fc","57a05b6787ce35099a674e19b526c7b98d7c4d22ce4ea6871c509394065dc31f","6f10b478756e257e1714ce6a3358f80243e458228cfcd59de9a0ed2a0407c124","b8c747cb3f59e99af7ac3f647b36fe96d69f690d538424e555e604a0d5197be7","82e15c3dc0e2862e90379305e665913f701f3c21dca5bab3cd0f142de4005fab","21c91ff8be2a6f82cdaeca7350f428f7226b39c88b142cca8bdb17a0063067e5","9101f2e20614abaeaff448ad92d9941ed676f96adbe423b141dbb542851a6c0d","fa93b9ba393a7ae00f12cde8aef1975e658ec085a44849fa29307e958d9cd48c","a0d9e15e6e7c9ed3e403db5d53568b51661179e20a33f793505c5336b5ef3d30","d0a6771ab7a396ca0396645d6b83f082802ac1daa8a771692abae69ca40b23b5","3d0e8f6b6394b97e70360053c802ce412512518be86e77ce2231e653cb8f9717","208ae559419335585733b80b58e5e498cc400a8f7cc5dbc43b8ad106432a32b0")
    val is_Bads_v3 = udf[Double, String]{xstr => any_to_double(Bads_v3.contains(xstr))}    
    Trans_ori_df = Trans_ori_df.withColumn("is_Bads_v3", is_Bads_v3(Trans_ori_df("mchnt_cd")))
    tmpdf = Trans_ori_df.groupBy("certid").agg(sum("is_Bads_v3") as "Bads_v3_cnt") 
    tmpdf = tmpdf.select(tmpdf("certid").as("certid_2"), tmpdf("Bads_v3_cnt"))
    count_mcc_df = count_mcc_df.join(tmpdf, count_mcc_df("certid")===tmpdf("certid_2"), "left_outer").drop("certid_2")
    
     
//    var Good_df = Trans_ori_df.filter(Trans_ori_df("label")=== 1)
//    var Bad_df = Trans_ori_df.filter(Trans_ori_df("label")=== 0)
//    var Bad_items = Bad_df.select("mchnt_cd").distinct()
//    var Good_items = Good_df.select("mchnt_cd").distinct()
//    var risk_items =  Bad_items.except(Good_items) 
//    
//    var mchnt_Bad_list = Bad_items.map(x=>x.getString(0)).collect()
//    var mchnt_risk_list = risk_items.map(x=>x.getString(0)).collect()
//    
//    
//    val is_risk_MC = udf[Double, String]{xstr => any_to_double(mchnt_risk_list.contains(xstr))}    
//    Trans_ori_df = Trans_ori_df.withColumn("is_risk_MC", is_risk_MC(Trans_ori_df("mchnt_cd")))
//    
//    
//    Trans_ori_df = Trans_ori_df.filter(Trans_ori_df("is_risk_MC")===1.0)
//    var count_mcc_df = Trans_ori_df.groupBy("mchnt_cd").agg(countDistinct("certid") as "certid_distinct") 
//    var tmpdf = Trans_ori_df.groupBy("mchnt_cd").agg(count("certid") as "certid_cnt") 
//    tmpdf = tmpdf.select(tmpdf("mchnt_cd").as("mchnt_cd_2"), tmpdf("certid_cnt"))
//    count_mcc_df = count_mcc_df.join(tmpdf, count_mcc_df("mchnt_cd")===tmpdf("mchnt_cd_2"), "left_outer").drop("certid_2")
//    
//    count_mcc_df=count_mcc_df.sort(count_mcc_df("certid_distinct").desc) 
//    
//   
   count_mcc_df = count_mcc_df.coalesce(1)
   var savepath = "xrli/credit/Mchnt_stat1122"
   val saveOptions = Map("header" -> "true", "path" -> savepath)
   count_mcc_df.write.format("com.databricks.spark.csv").mode(SaveMode.Overwrite).options(saveOptions).save()
    
    
    println("All done in " + (System.currentTimeMillis()-startTime)/(1000*60) + " minutes." ) 
    
    
    
    
    
     
  }
  
  

    
}